openapi: 3.0.3
info:
  title: SHIELD API
  version: 1.0.0
  description: Smart Housing Infrastructure and Entry Log Digitalization API
servers:
  - url: /api/v1
security:
  - bearerAuth: []
paths:
  /auth/login:
    post:
      tags: [Auth]
      summary: Login
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
  /auth/refresh:
    post:
      tags: [Auth]
      summary: Refresh token
      security: []
      responses:
        '200':
          description: Token refreshed
  /auth/logout:
    post:
      tags: [Auth]
      summary: Logout
      responses:
        '200':
          description: Logout successful

  /tenants:
    post:
      tags: [Tenant]
      summary: Create tenant
      responses:
        '200': {description: Tenant created}
  /tenants/{id}:
    get:
      tags: [Tenant]
      summary: Get tenant by id
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Tenant fetched}
    put:
      tags: [Tenant]
      summary: Update tenant
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Tenant updated}

  /units:
    post:
      tags: [Unit]
      summary: Create unit
      responses:
        '200': {description: Unit created}
    get:
      tags: [Unit]
      summary: List units
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Units fetched}
  /units/{id}:
    get:
      tags: [Unit]
      summary: Get unit by id
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Unit fetched}
    put:
      tags: [Unit]
      summary: Update unit
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Unit updated}
    delete:
      tags: [Unit]
      summary: Delete unit
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Unit deleted}

  /users:
    post:
      tags: [User]
      summary: Create user
      responses:
        '200': {description: User created}
    get:
      tags: [User]
      summary: List users
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Users fetched}
  /users/{id}:
    get:
      tags: [User]
      summary: Get user by id
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: User fetched}
    put:
      tags: [User]
      summary: Update user
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: User updated}
    delete:
      tags: [User]
      summary: Delete user
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: User deleted}

  /billing/generate:
    post:
      tags: [Billing]
      summary: Generate maintenance bill
      responses:
        '200': {description: Bill generated}
  /billing/unit/{unitId}:
    get:
      tags: [Billing]
      summary: Get bills by unit
      parameters:
        - in: path
          name: unitId
          required: true
          schema: {type: string, format: uuid}
      responses:
        '200': {description: Bills fetched}

  /payments:
    post:
      tags: [Billing]
      summary: Create payment
      responses:
        '200': {description: Payment created}
  /payments/{id}:
    get:
      tags: [Billing]
      summary: Get payment
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Payment fetched}

  /ledger:
    post:
      tags: [Accounting]
      summary: Create ledger entry
      responses:
        '200': {description: Ledger entry created}
    get:
      tags: [Accounting]
      summary: List ledger entries
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Ledger entries fetched}
  /ledger/summary:
    get:
      tags: [Accounting]
      summary: Ledger summary
      responses:
        '200': {description: Ledger summary fetched}

  /visitors/pass:
    post:
      tags: [Visitor]
      summary: Create visitor pass
      responses:
        '200': {description: Visitor pass created}
  /visitors/pass/{id}:
    get:
      tags: [Visitor]
      summary: Get visitor pass
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Visitor pass fetched}
  /visitors/pass/{id}/approve:
    put:
      tags: [Visitor]
      summary: Approve visitor pass
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Visitor pass approved}
  /visitors/pass/{id}/reject:
    put:
      tags: [Visitor]
      summary: Reject visitor pass
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Visitor pass rejected}

  /assets:
    post:
      tags: [Asset]
      summary: Create asset
      responses:
        '200': {description: Asset created}
    get:
      tags: [Asset]
      summary: List assets
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Assets fetched}
  /assets/{id}:
    get:
      tags: [Asset]
      summary: Get asset by id
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Asset fetched}
    put:
      tags: [Asset]
      summary: Update asset
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Asset updated}
    delete:
      tags: [Asset]
      summary: Delete asset
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Asset deleted}

  /complaints:
    post:
      tags: [Complaint]
      summary: Create complaint
      responses:
        '200': {description: Complaint created}
    get:
      tags: [Complaint]
      summary: List complaints
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Complaints fetched}
  /complaints/{id}/assign:
    put:
      tags: [Complaint]
      summary: Assign complaint
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Complaint assigned}
  /complaints/{id}/resolve:
    put:
      tags: [Complaint]
      summary: Resolve complaint
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Complaint resolved}

  /amenities:
    post:
      tags: [Amenities]
      summary: Create amenity
      responses:
        '200': {description: Amenity created}
    get:
      tags: [Amenities]
      summary: List amenities
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Amenities fetched}
  /amenities/{id}/book:
    post:
      tags: [Amenities]
      summary: Book amenity
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Amenity booked}
  /amenities/bookings:
    get:
      tags: [Amenities]
      summary: List amenity bookings
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Amenity bookings fetched}

  /meetings:
    post:
      tags: [Meeting]
      summary: Create meeting
      responses:
        '200': {description: Meeting created}
    get:
      tags: [Meeting]
      summary: List meetings
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Meetings fetched}
  /meetings/{id}/minutes:
    put:
      tags: [Meeting]
      summary: Update meeting minutes
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Meeting minutes updated}

  /announcements:
    post:
      tags: [Announcements]
      summary: Create announcement
      responses:
        '200': {description: Announcement created}
    get:
      tags: [Announcements]
      summary: List announcements
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Announcements fetched}
  /announcements/{id}:
    get:
      tags: [Announcements]
      summary: Get announcement by id
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Announcement fetched}
  /announcements/{id}/publish:
    post:
      tags: [Announcements]
      summary: Publish announcement and dispatch email notifications
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Announcement published}

  /notifications:
    get:
      tags: [Notifications]
      summary: List notification delivery logs
      parameters:
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
        - $ref: '#/components/parameters/Sort'
      responses:
        '200': {description: Notification logs fetched}
  /notifications/{id}:
    get:
      tags: [Notifications]
      summary: Get notification delivery log
      parameters:
        - $ref: '#/components/parameters/IdPath'
      responses:
        '200': {description: Notification log fetched}
  /notifications/send:
    post:
      tags: [Notifications]
      summary: Send manual email notification
      responses:
        '200': {description: Notification dispatch completed}

  /notification-preferences:
    get:
      tags: [Notifications]
      summary: Get current user notification preference
      responses:
        '200': {description: Notification preference fetched}
    put:
      tags: [Notifications]
      summary: Update current user notification preference
      responses:
        '200': {description: Notification preference updated}
  /notification-preferences/user/{userId}:
    get:
      tags: [Notifications]
      summary: Get notification preference by user id
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200': {description: Notification preference fetched}

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  parameters:
    IdPath:
      in: path
      name: id
      required: true
      schema:
        type: string
        format: uuid
    Page:
      in: query
      name: page
      schema:
        type: integer
        minimum: 0
        default: 0
    Size:
      in: query
      name: size
      schema:
        type: integer
        minimum: 1
        maximum: 200
        default: 20
    Sort:
      in: query
      name: sort
      schema:
        type: string
        example: createdAt,desc
  schemas:
    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
    ErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string
